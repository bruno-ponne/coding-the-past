<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-K2DKTESR2N"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-K2DKTESR2N');
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="effective data visualization, graphical data analysis with r, using ggplot in r, ggplot2 dotplot">
    <meta name="description" content="Code effective visualizations using ggplot2 dotplot.">
    <meta property= og:image content=/assets/images/lesson_03_06.png />
    <title>Climate Data Visualization</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <!-- Google Font: -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed&family=Montserrat&display=swap"
        rel="stylesheet">
    <!-- Google icon: -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Canonical Domain -->
    <link rel="canonical" href="http://localhost:4000/2023/01/24/Historical-Weather-Data.html">
</head>

<body>
    <div class="menu">
        <nav class="header-nav">
    <div class="logo">
        <a href="/"><img src="/assets/images/coding-the-past.png" alt="site logo"></a>
    </div>
    <ul class = "menu-items">
        
        <li>
            <a href="/" >
                home
            </a>
        </li>
        
        <li>
            <a href="/about.html" >
                about
            </a>
        </li>
        
    </ul>
</nav>
    </div>
    <div class="content">
        <div class="content-body">
            <div class="post-body">
    <h1 id = "post-main-title">Climate Data Visualization</h1>
    <p id = "author">Bruno Ponne &#9679 24 Jan 2023</p>
    <hr>
    <ul class = "meta-info">
        
        <li>Medium</li>
        
        <li>R</li>
        
        <li>20 min</li>
        
    </ul>
    <br>
    <h1>What you will learn</h1>
    <ul>
        
        <li class = "objectives"> Get comfortable with using ggplot2;</li>
        
        <li class = "objectives"> Be able create your own ggplot2 theme;</li>
        
        <li class = "objectives"> Learn how to code ggplot dot and line plots</li>
        
    </ul>
    <br>
    <h1>Table of Contents</h1>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#introduction">Introduction</a></li>
<li class="toc-entry toc-h1"><a href="#data-source">Data Source</a></li>
<li class="toc-entry toc-h1"><a href="#coding-the-past-graphical-data-analysis-with-r">Coding the past: graphical data analysis with r</a>
<ul>
<li class="toc-entry toc-h2"><a href="#1-loading-historical-weather-data-with-fread">1. Loading historical weather data with fread</a></li>
<li class="toc-entry toc-h2"><a href="#2-imputing-missing-values-in-r">2. Imputing missing values in R</a></li>
<li class="toc-entry toc-h2"><a href="#3-what-is-ggplot2-and-the-grammar-of-graphics">3. What is ggplot2 and the grammar of graphics?</a></li>
<li class="toc-entry toc-h2"><a href="#4-ggplot2-dotplot">4. ggplot2 dotplot</a></li>
<li class="toc-entry toc-h2"><a href="#5-setting-colors-with-scale_color_gradient">5. Setting colors with scale_color_gradient</a></li>
<li class="toc-entry toc-h2"><a href="#6-create-your-own-ggplot2-theme">6. Create your own ggplot2 theme</a></li>
<li class="toc-entry toc-h2"><a href="#7-adding-a-second-layer-containing-ggplot-line">7. Adding a second layer containing ggplot line</a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#conclusions">Conclusions</a></li>
</ul><p><br></p>

<h1 id="introduction">
<a class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p><strong>‘Global warming isn’t a prediction. It is happening.’</strong></p>

<p>James Hansen</p>

<p><br></p>

<p>There is indisputable evidence that our planet is warming at an abnormal rate. The effects of global warming already started to affect the Earth. Melting glaciers, sea level rise, and intense heat waves already affect several countries. In this lesson, you will use historical weather data to plot graphs that help to raise awareness about climate change.</p>

<p><br></p>

<p><br></p>

<hr>

<p><br></p>

<h1 id="data-source">
<a class="anchor" href="#data-source" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Source</h1>
<p>Data for this lesson comes from the <a href="https://www.ncei.noaa.gov/data/global-summary-of-the-year/access/UK000056225.csv" target="_blank">National Centers for Environmental Information</a>. This institution provides historical weather data by city and country over the last centuries.</p>

<p><br></p>

<p><br></p>

<hr>

<p><br></p>

<h1 id="coding-the-past-graphical-data-analysis-with-r">
<a class="anchor" href="#coding-the-past-graphical-data-analysis-with-r" aria-hidden="true"><span class="octicon octicon-link"></span></a>Coding the past: graphical data analysis with r</h1>

<h2 id="1-loading-historical-weather-data-with-fread">
<a class="anchor" href="#1-loading-historical-weather-data-with-fread" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Loading historical weather data with <em>fread</em>
</h2>

<p>First, we will load the <a href="http://localhost:4000/assets/data/oxford_temp.csv">temperature database</a> with the R function <code class="language-plaintext highlighter-rouge">fread()</code>. Note that there are many variables available (<a href="https://www.ncei.noaa.gov/pub/data/metadata/documents/GSOYReadme.txt" target="_blank">read more about them</a>). However, we are only interested in <em>DATE</em> and <em>TAVG</em> (average annual temperature in Oxford). The <code class="language-plaintext highlighter-rouge">select</code> parameter is used to select which variables to load.</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-1')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-1">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">imputeTS</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">

</span><span class="n">temperatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"oxford_temp.csv"</span><span class="p">,</span><span class="w">
                      </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"DATE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"TAVG"</span><span class="p">))</span></code></pre></figure>

</div>

<p><br></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="2-imputing-missing-values-in-r">
<a class="anchor" href="#2-imputing-missing-values-in-r" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Imputing missing values in R</h2>

<p><em>TAVG</em> has missing values and was loaded as character. Let us convert it to numeric and impute missing values with linear interpolation using ` na_interpolation`, available in the <em>imputeTS</em> library.</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-2')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-2">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">imputeTS</span><span class="p">)</span><span class="w">

</span><span class="n">temperatures</span><span class="o">$</span><span class="n">TAVG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na_interpolation</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">temperatures</span><span class="o">$</span><span class="n">TAVG</span><span class="p">),</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="s2">"linear"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br></p>

<p>If you prefer to skip steps 1 and 2, <a href="http://localhost:4000/assets/data/temperatures.RData">download here</a> the prepared dataset in <em>.RData</em> format. It will be used for the next steps.</p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="3-what-is-ggplot2-and-the-grammar-of-graphics">
<a class="anchor" href="#3-what-is-ggplot2-and-the-grammar-of-graphics" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. What is ggplot2 and the grammar of graphics?</h2>

<p><a href="https://ggplot2.tidyverse.org/" target="_blank">Ggplot2</a> is an R library to create statistical graphics. It is based in the <a href="https://vita.had.co.nz/papers/layered-grammar.html" target="_blank">grammar of graphics</a>, a tool to understand graphics as a set of components which together give you flexibility to create original visualizations.</p>

<p><br></p>

<p>In the figure bellow, you see the 3 main elements of ggplot2. First, you need a dataset with variables. Each of these variables can be mapped to one particular aesthetic - a visual property of a geom object. Geom objects are the elements you see in your graph (line and dots, for instance). Their characteristics (position on y axis, position on x axis, color, size, etc.) are defined by aesthetics mapping. One graph can contain several layers, each one with a geom object.</p>

<p><br></p>

<p><img src="/assets/images/lesson_03_01.png" alt="ggplot geom objects and layers"></p>

<p><br></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="4-ggplot2-dotplot">
<a class="anchor" href="#4-ggplot2-dotplot" aria-hidden="true"><span class="octicon octicon-link"></span></a>4. ggplot2 dotplot</h2>

<p>In this section, we will use ggplot2 to depict the historical temperatures in the city of Oxford from 1815 to 2022. We will use points do identify the temperature over the years. Although we usually use line plots to represent time series, some researchers claim that the lines do not represent observed data. Actually lines only connect the dots. Therefore, in this lesson, you will learn to plot time series both with dots and with lines.</p>

<p><br></p>

<div class="text-note">
    <span class="material-symbols-outlined">
        tips_and_updates
    </span>
    <span class="text-note-title">  </span> 
    <div class="text-note-content"> The author of "Fundamentals of Data Visualization", Claus O. Wilke, clarifies the use of dots and lines to plot time series. To read more about it, see
        
        <a href="https://clauswilke.com/dataviz/time-series.html" target="_blank"> the book here.</a>
        
    </div>
</div>

<p><br></p>

<p>The <code class="language-plaintext highlighter-rouge">ggplot()</code> function will contain two arguments. The first is the data and the second is <em>aes()</em> (aesthetics), which maps the position on the x axis to the variable <em>DATE</em>, the position on the y axis to <em>TAVG</em> and color to <em>TAVG</em>, meaning the color of the geom objects will depend on average annual temperature. After the mapping, we add the first layer of our plot with <code class="language-plaintext highlighter-rouge">geom_point()</code>. The points represent the observations in the dataset with x and y position as well as color defined by the mapping we set. Two additional layers set x and y axis names.</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-3')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-3">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br></p>

<p><br></p>

<p><img src="/assets/images/lesson_03_02.png" alt="ggplot dot plot with default theme"></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="5-setting-colors-with-scale_color_gradient">
<a class="anchor" href="#5-setting-colors-with-scale_color_gradient" aria-hidden="true"><span class="octicon octicon-link"></span></a>5. Setting colors with scale_color_gradient</h2>

<p>One improvement could be representing lower temperatures with blue colors and higher temperatures with red. Moreover this default behavior is not intuitive, since darker colors are usually associated with larger quantities and not otherwise. Note that <em>TAVG</em> is a numeric variable and when we map it to color, ggplot uses a gradient to color the geom object. Adding the <code class="language-plaintext highlighter-rouge">scale_color_gradient()</code> layer allows us to define the color associated with low and high values. Moreover, it allows us to choose the name of the scale:</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-4')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-4">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br></p>

<p><img src="/assets/images/lesson_03_03.png" alt="ggplot dot plot with customized colors"></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="6-create-your-own-ggplot2-theme">
<a class="anchor" href="#6-create-your-own-ggplot2-theme" aria-hidden="true"><span class="octicon octicon-link"></span></a>6. Create your own ggplot2 theme</h2>

<p>The plot above got a little better, but how to customize it further? There are several R packages providing ggplot2 themes, but if we would like a theme that matches the theme of this page, for example, what could we do? An option is to create our own theme with the <code class="language-plaintext highlighter-rouge">theme()</code> layer. <code class="language-plaintext highlighter-rouge">theme()</code> offers several arguments to create your style. In the figure bellow you can see the arguments necessary to change the background and text color of the elements in our plot. Moreover, there are arguments to eliminate grids.</p>

<p><br></p>

<p><img src="/assets/images/lesson_03_04.png" alt="ggplot theme arguments"></p>

<p><br></p>

<div class="text-note">
    <span class="material-symbols-outlined">
        tips_and_updates
    </span>
    <span class="text-note-title">  </span> 
    <div class="text-note-content"> To know more <i>theme()</i> arguments available, check
        
        <a href="https://ggplot2.tidyverse.org/reference/theme.html" target="_blank"> the ggplot2 reference page.</a>
        
    </div>
</div>

<p><br></p>

<p>A theme can be created by a customized function which executes the ggplot <code class="language-plaintext highlighter-rouge">theme()</code>. In the code bellow you can see that the theme is built starting from the black and white ggplot2 theme.</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-5')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-5">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">theme_coding_the_past</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="c1"># Changes panel, plot and legend background to dark gray:</span><span class="w">
        </span><span class="n">panel.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#2E3031'</span><span class="p">),</span><span class="w">
        </span><span class="n">plot.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#2E3031'</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"#2E3031"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes legend texts color to white:</span><span class="w">
        </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes color of plot border to white:</span><span class="w">
        </span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Eliminates grids:</span><span class="w">
        </span><span class="n">panel.grid.minor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="c1"># Changes color of axis texts to white</span><span class="w">
        </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes axis ticks color to white</span><span class="w">
        </span><span class="n">axis.ticks.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.ticks.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">}</span></code></pre></figure>


</div>

<p><br></p>

<p>Let us now try our theme:</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-6')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-6">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br></p>

<p><img src="/assets/images/lesson_03_05.png" alt="ggplot customized theme "></p>

<p><br></p>

<p>The plot fits the page and highlight the data a lot better now. You could still increase the size of your point geom objects to highlight them. When you do not want to map a certain aesthetic to a variable, you can declare it outside of the <code class="language-plaintext highlighter-rouge">aes()</code> argument. Bellow, two changes are made in the point geom objects. First, <code class="language-plaintext highlighter-rouge">alpha</code> adds transparency. Second, <code class="language-plaintext highlighter-rouge">size</code> increases the size of all the points (without mapping).</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-7')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-7">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br></p>

<p><img src="/assets/images/lesson_03_06.png" alt="ggplot customized theme with changes in size and alpha "></p>

<p><br></p>

<hr>

<p><br></p>

<h2 id="7-adding-a-second-layer-containing-ggplot-line">
<a class="anchor" href="#7-adding-a-second-layer-containing-ggplot-line" aria-hidden="true"><span class="octicon octicon-link"></span></a>7. Adding a second layer containing ggplot line</h2>

<p>Now we will make use of the flexibility of the grammar of graphics to add an additional layer to our plot. This time we will add a geom line object:</p>

<p><br></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-8')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-8">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br></p>

<p><img src="/assets/images/lesson_03_07.png" alt="ggplot customized theme with and a second geom layer "></p>

<p><br></p>

<p>It is clear that average temperatures are increasing year by year!</p>

<hr>

<p><br></p>

<h1 id="conclusions">
<a class="anchor" href="#conclusions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusions</h1>

<ul class="conclusion-list">
  <li>Ggplot2 creates effective statistical graphics making use of layers to produce flexible and original visualizations;</li>
  <li>Follow two basic steps to plot in ggplot2:
    <ul>
      <li>map your variables to the desired aesthetics (visual aspect of a geom object);</li>
      <li>create the layers containing the geom objects;</li>
    </ul>
  </li>
  <li>Use <code class="language-plaintext highlighter-rouge">theme()</code> to create your own customized theme;</li>
</ul>

<p><br></p>

<hr>

</div>
<div class = "share">
    

<style>
#share-buttons {display: inline-block; vertical-align: middle; }
#share-buttons:after {content: ""; display: block; clear: both;}
#share-buttons > div {
    position: relative;
    text-align: left; 
    height: 36px; 
    width: 32px; 
    float: left; 
    text-align: center;
}
#share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;}
#share-buttons > div:hover {cursor: pointer;}
#share-buttons > div.facebook:hover > svg {fill: #3B5998;}
#share-buttons > div.twitter:hover > svg {fill: #55ACEE;}
#share-buttons > div.linkedin:hover > svg {fill: #0077b5;}
#share-buttons > div.pinterest:hover > svg {fill: #CB2027;}
#share-buttons > div.gplus:hover > svg {fill: #dd4b39;}
#share-buttons > div.mail:hover > svg {fill: #7D7D7D;}
#share-buttons > div.instagram:hover > svg {fill: #C73B92;}
#share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;}
#share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;}
#share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;}
#share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;}
#share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;}
#share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}
</style>

<span style="color: white;"> Share on </span><div id="share-buttons">
    <div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=http://localhost:4000/2023/01/24/Historical-Weather-Data.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div>
    <div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=http://localhost:4000/2023/01/24/Historical-Weather-Data.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div>
    <div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2023/01/24/Historical-Weather-Data.html&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div>
    <div class="pinterest" title="Share this on Pinterest" onclick="window.open('https://pinterest.com/pin/create/button/?url=&media=http://localhost:4000lesson_03.jpeg&description=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M256 597q0-108 37.5-203.5t103.5-166.5 152-123 185-78 202-26q158 0 294 66.5t221 193.5 85 287q0 96-19 188t-60 177-100 149.5-145 103-189 38.5q-68 0-135-32t-96-88q-10 39-28 112.5t-23.5 95-20.5 71-26 71-32 62.5-46 77.5-62 86.5l-14 5-9-10q-15-157-15-188 0-92 21.5-206.5t66.5-287.5 52-203q-32-65-32-169 0-83 52-156t132-73q61 0 95 40.5t34 102.5q0 66-44 191t-44 187q0 63 45 104.5t109 41.5q55 0 102-25t78.5-68 56-95 38-110.5 20-111 6.5-99.5q0-173-109.5-269.5t-285.5-96.5q-200 0-334 129.5t-134 328.5q0 44 12.5 85t27 65 27 45.5 12.5 30.5q0 28-15 73t-37 45q-2 0-17-3-51-15-90.5-56t-61-94.5-32.5-108-11-106.5z"/></svg></div>
    <div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=http://localhost:4000/2023/01/24/Historical-Weather-Data.html');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div>
</div>
</div>

<button onclick="topFunction()" id="myBtn" title="Go to the top">
    <span class="material-symbols-outlined">
        keyboard_double_arrow_up
    </span>
</button>





        </div>
    </div>
    <div class="footer">
        <footer class="footer">
    <div class="footer-content">
        <!-- Begin Mailchimp Signup Form -->
        <link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css">
        <div id="mc_embed_signup">
            <form
                action="https://gmail.us13.list-manage.com/subscribe/post?u=ae95cc65e2d79bab1a22dba39&amp;id=9481205f08&amp;f_id=002cabe2f0"
                method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate"
                target="_blank" novalidate>
                <div id="mc_embed_signup_scroll">
                    <h2><b>Subscribe here to know about new lessons!</b> </h2>
                    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
                    <div class="mc-field-group">
                        <label for="mce-EMAIL">Email Address <span class="asterisk">*</span>
                        </label>
                        <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required>
                        <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                    </div>
                    <div id="mce-responses" class="clear foot">
                        <div class="response" id="mce-error-response" style="display:none"></div>
                        <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>
                    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text"
                            name="b_ae95cc65e2d79bab1a22dba39_9481205f08" tabindex="-1" value=""></div>
                    <div class="optionalParent">
                        <div class="clear foot">
                            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
                                class="button">
                            <p class="brandingLogo"><a href="http://eepurl.com/ikypNP"
                                    title="Mailchimp - email marketing made easy and fun"><img
                                        src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a>
                            </p>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script>
        <script
            type='text/javascript'>(function ($) { window.fnames = new Array(); window.ftypes = new Array(); fnames[0] = 'EMAIL'; ftypes[0] = 'email'; fnames[1] = 'FNAME'; ftypes[1] = 'text'; fnames[2] = 'LNAME'; ftypes[2] = 'text'; fnames[3] = 'ADDRESS'; ftypes[3] = 'address'; fnames[4] = 'PHONE'; ftypes[4] = 'phone'; fnames[5] = 'BIRTHDAY'; ftypes[5] = 'birthday'; }(jQuery)); var $mcj = jQuery.noConflict(true);
        </script>
        <!--End mc_embed_signup-->
        <div>
            Coding the Past © 2022 Copyright
        </div>
    </div>
</footer>
    </div>
</body>
<script src="/assets/js/copycode.js"></script>
<script src="/assets/js/up.js"></script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
    type="text/javascript"></script>

</html>