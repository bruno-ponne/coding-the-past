<p><br /></p>

<h1 id="introduction">Introduction</h1>

<p><strong>‘Global warming isn’t a prediction. It is happening.’</strong></p>

<p>James Hansen</p>

<p><br /></p>

<p>There is indisputable evidence that our planet is warming at an abnormal rate. The effects of global warming already started to affect the Earth. Melting glaciers, sea level rise, and intense heat waves already affect several countries. In this lesson, you will use historical weather data to plot graphs that help to raise awareness about climate change.</p>

<p><br /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="data-source">Data Source</h1>
<p>Data for this lesson comes from the <a href="https://www.ncei.noaa.gov/data/global-summary-of-the-year/access/UK000056225.csv" target="_blank">National Centers for Environmental Information</a>. This institution provides historical weather data by city and country over the last centuries.</p>

<p><br /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="coding-the-past-graphical-data-analysis-with-r">Coding the past: graphical data analysis with r</h1>

<h2 id="1-loading-historical-weather-data-with-fread">1. Loading historical weather data with <em>fread</em></h2>

<p>First, we will load the <a href="http://localhost:4000/assets/data/oxford_temp.csv">temperature database</a> with the R function <code class="language-plaintext highlighter-rouge">fread()</code>. Note that there are many variables available (<a href="https://www.ncei.noaa.gov/pub/data/metadata/documents/GSOYReadme.txt" target="_blank">read more about them</a>). However, we are only interested in <em>DATE</em> and <em>TAVG</em> (average annual temperature in Oxford). The <code class="language-plaintext highlighter-rouge">select</code> parameter is used to select which variables to load.</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-1')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-1">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">imputeTS</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">

</span><span class="n">temperatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fread</span><span class="p">(</span><span class="s2">"oxford_temp.csv"</span><span class="p">,</span><span class="w">
                      </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"DATE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"TAVG"</span><span class="p">))</span></code></pre></figure>

</div>

<p><br /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="2-imputing-missing-values-in-r">2. Imputing missing values in R</h2>

<p><em>TAVG</em> has missing values and was loaded as character. Let us convert it to numeric and impute missing values with linear interpolation using ` na_interpolation`, available in the <em>imputeTS</em> library.</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-2')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-2">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">imputeTS</span><span class="p">)</span><span class="w">

</span><span class="n">temperatures</span><span class="o">$</span><span class="n">TAVG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">na_interpolation</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">temperatures</span><span class="o">$</span><span class="n">TAVG</span><span class="p">),</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="s2">"linear"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br /></p>

<p>If you prefer to skip steps 1 and 2, <a href="http://localhost:4000/assets/data/temperatures.RData">download here</a> the prepared dataset in <em>.RData</em> format. It will be used for the next steps.</p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="3-what-is-ggplot2-and-the-grammar-of-graphics">3. What is ggplot2 and the grammar of graphics?</h2>

<p><a href="https://ggplot2.tidyverse.org/" target="_blank">Ggplot2</a> is an R library to create statistical graphics. It is based in the <a href="https://vita.had.co.nz/papers/layered-grammar.html" target="_blank">grammar of graphics</a>, a tool to understand graphics as a set of components which together give you flexibility to create original visualizations.</p>

<p><br /></p>

<p>In the figure bellow, you see the 3 main elements of ggplot2. First, you need a dataset with variables. Each of these variables can be mapped to one particular aesthetic - a visual property of a geom object. Geom objects are the elements you see in your graph (line and dots, for instance). Their characteristics (position on y axis, position on x axis, color, size, etc.) are defined by aesthetics mapping. One graph can contain several layers, each one with a geom object.</p>

<p><br /></p>

<p><img src="/assets/images/lesson_03_01.png" alt="ggplot geom objects and layers" /></p>

<p><br /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="4-ggplot2-dotplot">4. ggplot2 dotplot</h2>

<p>In this section, we will use ggplot2 to depict the historical temperatures in the city of Oxford from 1815 to 2022. We will use points do identify the temperature over the years. Although we usually use line plots to represent time series, some researchers claim that the lines do not represent observed data. Actually lines only connect the dots. Therefore, in this lesson, you will learn to plot time series both with dots and with lines.</p>

<p><br /></p>

<div class="text-note">
    <span class="material-symbols-outlined">
        tips_and_updates
    </span>
    <span class="text-note-title">&nbsp; </span> 
    <div class="text-note-content"> The author of "Fundamentals of Data Visualization", Claus O. Wilke, clarifies the use of dots and lines to plot time series. To read more about it, see
        
        <a href="https://clauswilke.com/dataviz/time-series.html" target="_blank"> the book here.</a>
        
    </div>
</div>

<p><br /></p>

<p>The <code class="language-plaintext highlighter-rouge">ggplot()</code> function will contain two arguments. The first is the data and the second is <em>aes()</em> (aesthetics), which maps the position on the x axis to the variable <em>DATE</em>, the position on the y axis to <em>TAVG</em> and color to <em>TAVG</em>, meaning the color of the geom objects will depend on average annual temperature. After the mapping, we add the first layer of our plot with <code class="language-plaintext highlighter-rouge">geom_point()</code>. The points represent the observations in the dataset with x and y position as well as color defined by the mapping we set. Two additional layers set x and y axis names.</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-3')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-3">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br /></p>

<p><br /></p>

<p><img src="/assets/images/lesson_03_02.png" alt="ggplot dot plot with default theme" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="5-setting-colors-with-scale_color_gradient">5. Setting colors with scale_color_gradient</h2>

<p>One improvement could be representing lower temperatures with blue colors and higher temperatures with red. Moreover this default behavior is not intuitive, since darker colors are usually associated with larger quantities and not otherwise. Note that <em>TAVG</em> is a numeric variable and when we map it to color, ggplot uses a gradient to color the geom object. Adding the <code class="language-plaintext highlighter-rouge">scale_color_gradient()</code> layer allows us to define the color associated with low and high values. Moreover, it allows us to choose the name of the scale:</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-4')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-4">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span></code></pre></figure>


</div>

<p><br /></p>

<p><img src="/assets/images/lesson_03_03.png" alt="ggplot dot plot with customized colors" /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="6-create-your-own-ggplot2-theme">6. Create your own ggplot2 theme</h2>

<p>The plot above got a little better, but how to customize it further? There are several R packages providing ggplot2 themes, but if we would like a theme that matches the theme of this page, for example, what could we do? An option is to create our own theme with the <code class="language-plaintext highlighter-rouge">theme()</code> layer. <code class="language-plaintext highlighter-rouge">theme()</code> offers several arguments to create your style. In the figure bellow you can see the arguments necessary to change the background and text color of the elements in our plot. Moreover, there are arguments to eliminate grids.</p>

<p><br /></p>

<p><img src="/assets/images/lesson_03_04.png" alt="ggplot theme arguments" /></p>

<p><br /></p>

<div class="text-note">
    <span class="material-symbols-outlined">
        tips_and_updates
    </span>
    <span class="text-note-title">&nbsp; </span> 
    <div class="text-note-content"> To know more <i>theme()</i> arguments available, check
        
        <a href="https://ggplot2.tidyverse.org/reference/theme.html" target="_blank"> the ggplot2 reference page.</a>
        
    </div>
</div>

<p><br /></p>

<p>A theme can be created by a customized function which executes the ggplot <code class="language-plaintext highlighter-rouge">theme()</code>. In the code bellow you can see that the theme is built starting from the black and white ggplot2 theme.</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-5')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-5">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">theme_coding_the_past</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="c1"># Changes panel, plot and legend background to dark gray:</span><span class="w">
        </span><span class="n">panel.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#2E3031'</span><span class="p">),</span><span class="w">
        </span><span class="n">plot.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'#2E3031'</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.background</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"#2E3031"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes legend texts color to white:</span><span class="w">
        </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes color of plot border to white:</span><span class="w">
        </span><span class="n">panel.border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_rect</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Eliminates grids:</span><span class="w">
        </span><span class="n">panel.grid.minor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="c1"># Changes color of axis texts to white</span><span class="w">
        </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_text</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="c1"># Changes axis ticks color to white</span><span class="w">
        </span><span class="n">axis.ticks.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">),</span><span class="w">
        </span><span class="n">axis.ticks.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">
</span><span class="p">}</span></code></pre></figure>


</div>

<p><br /></p>

<p>Let us now try our theme:</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-6')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-6">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br /></p>

<p><img src="/assets/images/lesson_03_05.png" alt="ggplot customized theme " /></p>

<p><br /></p>

<p>The plot fits the page and highlight the data a lot better now. You could still increase the size of your point geom objects to highlight them. When you do not want to map a certain aesthetic to a variable, you can declare it outside of the <code class="language-plaintext highlighter-rouge">aes()</code> argument. Bellow, two changes are made in the point geom objects. First, <code class="language-plaintext highlighter-rouge">alpha</code> adds transparency. Second, <code class="language-plaintext highlighter-rouge">size</code> increases the size of all the points (without mapping).</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-7')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-7">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br /></p>

<p><img src="/assets/images/lesson_03_06.png" alt="ggplot customized theme with changes in size and alpha " /></p>

<p><br /></p>

<hr />

<p><br /></p>

<h2 id="7-adding-a-second-layer-containing-ggplot-line">7. Adding a second layer containing ggplot line</h2>

<p>Now we will make use of the flexibility of the grammar of graphics to add an additional layer to our plot. This time we will add a geom line object:</p>

<p><br /></p>

<p><span class="material-symbols-outlined" id="copy-button" onclick="copyCode('code-3-8')">
  content_copy
  <span class="tooltiptext">Copy</span>
</span></p>

<div id="code-3-8">

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperatures</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">DATE</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TAVG</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_gradient</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ºC"</span><span class="p">,</span><span class="w"> </span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1AA3FF"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#FF6885"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Annual Mean Temperature in Oxford [ºC]"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_coding_the_past</span><span class="p">()</span></code></pre></figure>


</div>

<p><br /></p>

<p><img src="/assets/images/lesson_03_07.png" alt="ggplot customized theme with and a second geom layer " /></p>

<p><br /></p>

<p>It is clear that average temperatures are increasing year by year!</p>

<hr />

<p><br /></p>

<h1 id="conclusions">Conclusions</h1>

<ul class="conclusion-list">
  <li>Ggplot2 creates effective statistical graphics making use of layers to produce flexible and original visualizations;</li>
  <li>Follow two basic steps to plot in ggplot2:
    <ul>
      <li>map your variables to the desired aesthetics (visual aspect of a geom object);</li>
      <li>create the layers containing the geom objects;</li>
    </ul>
  </li>
  <li>Use <code class="language-plaintext highlighter-rouge">theme()</code> to create your own customized theme;</li>
</ul>

<p><br /></p>

<hr />
